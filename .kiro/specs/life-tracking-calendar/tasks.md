# 实施计划

## 阶段1：基础项目设置和日历界面

- [x] 1. 项目初始化和依赖配置
  - 清理默认代码，设置项目基础结构
  - 添加必要的依赖包（table_calendar, provider, sqflite等）
  - 配置应用主题和基础样式
  - _需求: 8.1, 8.3, 9.1_

- [x] 2. 创建基础日历界面
  - 实现基础的月视图日历组件
  - 添加日期选择功能
  - 实现简洁的现代化UI设计
  - _需求: 1.1, 8.1, 8.2_

- [x] 3. 实现日历导航功能

  - 添加月份切换功能（前一月/后一月）
  - 实现今天按钮快速回到当前日期
  - 添加流畅的切换动画效果
  - _需求: 8.2, 8.4_

## 阶段2：数据存储和管理基础
- [x] 4. 创建数据模型
  - 定义Tag、TagRecord、DiaryEntry等核心数据模型
  - 实现标签类型枚举（量化、非量化、复杂）
  - 创建基础的数据验证逻辑
  - _需求: 1.2, 2.1, 3.1_

- [x] 5. 实现本地数据存储
  - 设置SQLite数据库结构
  - 实现标签和记录的CRUD操作
  - 创建数据访问层（Repository模式）
  - _需求: 9.4_

## 阶段3：标签系统基础实现

- [x] 6. 实现标签管理界面
  - 创建标签列表显示界面
  - 实现添加新标签功能
  - 支持标签的编辑和删除
  - _需求: 1.2, 2.1, 3.1_

- [x] 7. 实现量化标签功能和折叠式标签管理界面
  - _需求: 1.2, 1.3, 1.6, 1.7, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7_

- [x] 7.1 重构日历界面布局
  - 移除日历下方的选中日期信息显示模块
  - 移除"记录"按钮和今天标识
  - 移除当日记录数据显示模块
  - 调整日历界面的整体布局结构
  - _需求: 4.7_

- [x] 7.2 创建折叠式标签管理面板组件
  - 创建TagManagementPanel组件，宽度与日历一致
  - 实现折叠/展开动画效果
  - 设计标签展示的网格布局
  - 实现已添加标签和未添加标签的视觉区分（原色 vs 半透明）
  - _需求: 4.1, 4.2, 4.7_

- [x] 7.3 实现标签长按交互功能
  - 为已添加标签实现长按弹出修改/删除窗口
  - 为未添加标签实现长按自动添加并弹出修改窗口
  - 创建标签数值修改弹窗组件
  - 实现标签删除确认功能
  - _需求: 4.3, 4.4_

- [x] 7.4 实现单标签聚焦模式
  - 实现点击标签时隐藏日历上其他标签数据的功能
  - 保证实现方式能扩展到其他类型的标签上
  - 为量化标签创建热力图显示模式
  - 实现点击空白处恢复所有标签显示
  - 添加聚焦状态的视觉指示器
  - _需求: 4.5, 4.6, 1.6, 1.7_

- [x] 7.5 优化日历数据可视化
  - 重构日历单元格的标签数据渲染逻辑
  - 实现量化标签的颜色深浅可视化
  - 实现热力图模式下的数值显示
  - 优化标签数据的加载和缓存机制
  - 实现点击日历模块和标签列表模块之外空白处也能恢复所有标签显示
  - _需求: 1.2, 1.3, 1.4_

## 阶段4：标签类型扩展

- [x] 8. 实现非量化标签功能
  - 创建图标选择器界面
  - 在日历上显示图标标记
  - 为非量化标签创建放大标记显示模式
  - _需求: 2.1, 2.2, 2.3_

- [x] 9. 实现复杂标签功能
  - 在原先折叠式标签管理面板组件下方再创建一个为复杂标签专用的折叠式标签管理面板组件
  - 长按复杂标签，显示复杂标签专用的折叠式标签管理面板组件，并包含该复杂标签所包含的量化和非量化标签，选中与未选中逻辑与原先折叠式标签管理面板一致
  - 实现子标签的动态添加和管理
  - 支持复杂标签的保存和其子标签的聚焦模式显示
  - _需求: 3.1, 3.2, 3.3, 3.4_

## 阶段4.5：用户测试
- [x] 利用现有的数据库演示功能，再添加几个用于测试的数据库操作：
  - 创建一个随机量化标签生成器，随机名字随机数值，随机填充当月（2025年7月，下同）日历；
  - 创建一个随机非量化标签生成器，功能同上；
  - 创建一个随机复杂标签生成器，其子标签也要生成，规律同上。
  - 创建一个生成器，模拟用户使用一年后的日历情况

## 阶段5：日记界面集成

- [ ] 10. 创建日记输入界面
  - 上拉日历页面打开当日日记界面（没有边框，观感上就像是日历界面是盖在日记上的）
  - 实现预设标签行的快速输入界面
  - 创建大文本框支持富文本输入
  - 集成标签输入和日记内容编辑
  - _需求: 4.1, 4.2, 4.4_

- [ ] 11. 实现多媒体支持
  - 添加图像、音频、视频的录制和选择功能
  - 实现多媒体文件的本地存储
  - 在日记界面中显示多媒体内容
  - _需求: 4.3_

## 阶段6：数据查询和分析

- [ ] 12. 实现数据查询和筛选
  - 实现按标签筛选功能
  - 创建标签数据的统计和趋势分析
  - 支持日期范围查询
  - _需求: 7.1, 7.2, 7.3, 7.4_

## 阶段7：数据可视化增强

- [ ] 13. 实现条形图功能
  - 创建条形图日历组件，与日历组件相同，包含月视图周视图
  - 显示各标签的状态变化趋势
  - 实现视图的切换
  - _需求: 1.5, 1.6_

- [ ] 14. 增强数据可视化
  - 实现条形图显示标签状态起伏
  - 优化颜色深浅的视觉效果
  - 添加数值显示选项
  - _需求: 1.4, 8.3_

## 阶段8：预测功能实现

- [ ] 15. 实现周期设置功能
  - 创建手动周期设置界面
  - 实现周期天数和单位的输入
  - 保存和管理标签的周期配置
  - _需求: 5.1, 5.3_

- [ ] 16. 实现预测算法
  - 开发基于历史数据的周期分析算法
  - 实现自动周期检测功能
  - 生成未来日期的预测标签
  - _需求: 5.2, 5.4, 5.5_

- [ ] 17. 实现预测显示功能
  - 在日历上显示半透明的预测标签
  - 实现预测和实际记录的视觉区分
  - 添加预测依据的详情显示
  - _需求: 6.1, 6.2, 6.3_

## 阶段9：用户体验优化

- [ ] 18. 实现主题适配
  - 支持深色/浅色主题切换
  - 优化不同主题下的颜色方案
  - 实现系统主题自动跟随
  - _需求: 8.5_

- [ ] 19. 实现预测交互功能
  - 添加预测到达时的提醒功能
  - 实现预测标签的确认和更新
  - 支持实际记录替换预测标签
  - _需求: 6.4, 6.5_

## 阶段10：云同步和跨平台

- [ ] 20. 实现云同步基础架构
  - 集成Firebase或Supabase服务
  - 实现用户认证系统
  - 创建云端数据模型
  - _需求: 9.2_

- [ ] 21. 实现数据同步功能
  - 开发增量同步机制
  - 实现冲突解决策略
  - 添加同步状态指示器
  - _需求: 9.2, 9.4_

- [ ] 22. 实现响应式布局
  - 优化不同屏幕尺寸的界面适配
  - 实现平板和手机的布局差异化
  - 测试iOS和Android平台兼容性
  - _需求: 9.1, 9.3_

## 阶段11：测试和优化

- [ ] 23. 实现单元测试
  - 为核心业务逻辑编写单元测试
  - 测试数据模型和验证逻辑
  - 测试预测算法的准确性
  - _测试策略要求_

- [ ] 24. 实现集成测试
  - 测试完整的用户操作流程
  - 验证数据存储和同步功能
  - 测试错误处理和恢复机制
  - _测试策略要求_

- [ ] 25. 性能优化和最终调试
  - 优化大数据量下的应用性能
  - 修复发现的bug和用户体验问题
  - 进行最终的跨平台测试
  - _测试策略要求_